{% extends "base.html" %}

{% block title %}Models - NBA Prediction System{% endblock %}

{% block content %}
<div class="container">
    <h2 class="mb-4">Model Performance Comparison</h2>

    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Model Accuracy Comparison</h5>
                </div>
                <div class="card-body">
                    <img src="{{ url_for('static', filename='img/model_comparison.png') }}" 
                         class="img-fluid clickable-image" alt="Model Accuracy Comparison"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Model Accuracy Comparison')">
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Performance Metrics Comparison</h5>
                </div>
                <div class="card-body">
                    <img src="{{ url_for('static', filename='img/performance_comparison.png') }}" 
                         class="img-fluid clickable-image" alt="Performance Metrics Comparison"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Performance Metrics Comparison')">
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Logistic Regression Model</h5>
                </div>
                <div class="card-body">
                    <img src="{{ url_for('static', filename='img/logistic_regression/confusion_matrix.png') }}" 
                         class="img-fluid mb-3 clickable-image" alt="Logistic Regression Confusion Matrix"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Logistic Regression Confusion Matrix')">
                    <h6>Feature Importance</h6>
                    <img src="{{ url_for('static', filename='img/logistic_regression/feature_importance.png') }}" 
                         class="img-fluid clickable-image" alt="Logistic Regression Feature Importance"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Logistic Regression Feature Importance')">
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Random Forest Model</h5>
                </div>
                <div class="card-body">
                    <img src="{{ url_for('static', filename='img/random_forest/confusion_matrix.png') }}" 
                         class="img-fluid mb-3 clickable-image" alt="Random Forest Confusion Matrix"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Random Forest Confusion Matrix')">
                    <h6>Feature Importance</h6>
                    <img src="{{ url_for('static', filename='img/random_forest/feature_importance.png') }}" 
                         class="img-fluid clickable-image" alt="Random Forest Feature Importance"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'Random Forest Feature Importance')">
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">ELO Rating System</h5>
                </div>
                <div class="card-body">
                    <img src="{{ url_for('static', filename='img/elo_rating/confusion_matrix.png') }}" 
                         class="img-fluid mb-3 clickable-image" alt="ELO Rating Confusion Matrix"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'ELO Rating Confusion Matrix')">
                    <h6>Team Ratings</h6>
                    <img src="{{ url_for('static', filename='img/elo_rating/team_ratings.png') }}" 
                         class="img-fluid clickable-image" alt="ELO Team Ratings"
                         data-bs-toggle="modal" data-bs-target="#imageModal"
                         onclick="showImage(this.src, 'ELO Team Ratings')">
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Model Comparison Summary</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>True Negatives</th>
                                    <th>False Positives</th>
                                    <th>False Negatives</th>
                                    <th>True Positives</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Logistic Regression</td>
                                    <td>1,661</td>
                                    <td>500</td>
                                    <td>422</td>
                                    <td>2,581</td>
                                </tr>
                                <tr>
                                    <td>Random Forest</td>
                                    <td>1,542</td>
                                    <td>619</td>
                                    <td>390</td>
                                    <td>2,613</td>
                                </tr>
                                <tr>
                                    <td>ELO Rating</td>
                                    <td>1,363</td>
                                    <td>791</td>
                                    <td>1,227</td>
                                    <td>1,783</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Model Evaluation Details</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Accuracy</th>
                                    <th>Precision</th>
                                    <th>Recall</th>
                                    <th>F1 Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Logistic Regression</td>
                                    <td>{{ logistic_metrics.accuracy if logistic_metrics else 'N/A' }}</td>
                                    <td>{{ logistic_metrics.precision if logistic_metrics else 'N/A' }}</td>
                                    <td>{{ logistic_metrics.recall if logistic_metrics else 'N/A' }}</td>
                                    <td>{{ logistic_metrics.f1 if logistic_metrics else 'N/A' }}</td>
                                </tr>
                                <tr>
                                    <td>Random Forest</td>
                                    <td>{{ rf_metrics.accuracy if rf_metrics else 'N/A' }}</td>
                                    <td>{{ rf_metrics.precision if rf_metrics else 'N/A' }}</td>
                                    <td>{{ rf_metrics.recall if rf_metrics else 'N/A' }}</td>
                                    <td>{{ rf_metrics.f1 if rf_metrics else 'N/A' }}</td>
                                </tr>
                                <tr>
                                    <td>ELO Rating</td>
                                    <td>{{ elo_metrics.accuracy if elo_metrics else 'N/A' }}</td>
                                    <td>{{ elo_metrics.precision if elo_metrics else 'N/A' }}</td>
                                    <td>{{ elo_metrics.recall if elo_metrics else 'N/A' }}</td>
                                    <td>{{ elo_metrics.f1 if elo_metrics else 'N/A' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="imageModalLabel">Image Preview</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <img id="modalImage" src="" class="img-fluid" alt="Modal Image">
            </div>
        </div>
    </div>
</div>

<style>
.clickable-image {
    cursor: pointer;
    transition: opacity 0.3s;
}
.clickable-image:hover {
    opacity: 0.8;
}
</style>

<script>
function showImage(src, title) {
    document.getElementById('modalImage').src = src;
    document.getElementById('imageModalLabel').textContent = title;
}
</script>
{% endblock %} 